{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/personalization-new.css' %}"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />

    
    <div class="large-bubble" id="image-selector" style="display:none; overflow: hidden; text-align:center; box-shadow: 1px 1px 10px black; background-color: rgb(50,50,50);Z-index:28; height: 0vh; width: 0vw;">
        <h4>Select from Uploads</h4>
        <div id="image-grid-container" style="height: 80%;">
        </div>
        <div>
            <button id="cancel-button">Cancel</button>
            <button id="select-button">Select</button>

        
        </div>
    </div>            
    <script>
        let cancel_button = document.getElementById("cancel-button");
        cancel_button.addEventListener("click", function() {
            let selector_container = document.getElementById("image-selector");
            $("#image-selector").animate({"height": "0vh", "width":"0vw"}, "fast").fadeOut();
        });
    </script>
    <div id='preview-area' style="display:none;">
        <div id='accent-color-preview' class='profile-image-preview'>
            <img class='profile-image-preview-image' id='profile-image-preview-image' src="">
        </div>


    </div>
    <div id="split-content-container">
        <div id="container-column-1">

            
            <!-- Profile Image Cropper -->
            
            <div class="dropdown-large" id="profile-cropper" style="display:none; left: 2.5px; position: relative; margin-left: auto; margin-right: auto;">
                <button id="profile-cropper-back" class="yb-form-button" style="background-color: darkred;" data-state="0">Back</button>
                <button id="profile-cropper-select-button" class="yb-form-button" onclick="showImageSelection()">Select from Uploads</button>
                <button id="profile-upload-button" class="yb-form-button" onclick="showUpload('profile-image')">Upload New</button>
                <input type="file" id="profile-image-input" style="width:225px; display:none;" onchange="previewImage('profile-image')" />
                <br>
                <br>
                <img id="profile-image-preview" style=" object-fit: contain;max-width:100%; max-height: 250px; margin-left: auto; margin-right: auto;"/>
                <br />
                <input type="hidden" id="cropper-output" value="">
                <div id="profile-cropper-submission-controls" style="display:none; width:100%; background-color: rgba(0, 0, 0, 0.5);">
                    <button id="profile-advanced-options-button" style="margin-top: 2px; position: absolute; left: 5px;" class = "yb-form-button">Show Advanced Options</button>
                    <button id="cropper-save" class="yb-form-button" style="background-color: darkgreen; position: absolute; right: 5px;" onclick="uploadImage('profile-image')">Save</button>
                </div>

            </div>
            <script>
                let profile_image_back_button = document.getElementById("profile-cropper-back");
                profile_image_back_button.addEventListener("click", function() {
                    console.log("clicked")
                    let state = this.getAttribute("data-state");
                    console.log(state)
                    if (state === "0"){
                        $("#profile-cropper").fadeOut();
                        $("#background-cropper").fadeOut();
                        $("#profile-images").fadeIn();
                    } else {
                        $("#profile-cropper-select-button").fadeIn();
                        $("#upload-button").fadeIn();
                        $("#profile-image-input").hide();
                    }
                });
            </script>
            <div class="dropdown-large" id="background-cropper" style="display:none; left: 2.5px; position: relative; margin-left: auto; margin-right: auto;">
                <button id="background-cropper-back" class="yb-form-button" style="background-color: darkred;" data-state="0">Back</button>
                <button id="background-cropper-select-button" class="yb-form-button" onclick="showImageSelection()">Select from Uploads</button>
                <button id="background-`upload-button" class="yb-form-button" onclick="showUpload('background-image')">Upload New</button>
                <input type="file" id="background-image-input" style="width:225px; display:none;" onchange="previewImage('mobile-background')" />
                <br />
                <br />
                <img id="background-image-preview" style="object-fit: contain;max-width:100%; max-height: 250px; margin-left: auto; margin-right: auto;"/>
                <br />
                <br />
                <input type="hidden" id="cropper-output" value="">
                <div id="background-cropper-submission-controls" style="display:none; width:100%; text-align:center;">
                    
                        <button id="background-advanced-options-button" style="margin-top: 2px; position: absolute; left: 5px;" class = "yb-form-button">Show Advanced Options</button>
                        <button id="cropper-save" class="yb-form-button" style="background-color: darkgreen; position: absolute; right: 5px;" onclick="uploadImage('background-image')">Save</button>
                    
                </div>
                
            <script>         
                let background_image_back_button = document.getElementById("background-cropper-back");
                background_image_back_button.addEventListener("click", function() {
                    let state = this.getAttribute("data-state");
                    console.log("clicked");
                    console.log(state);
                    if (state === "0"){
                        $("#profile-cropper").fadeOut();
                        $("#background-cropper").fadeOut();
                        $("#profile-images").fadeIn();
                    } else {
                        $("#background-cropper-select-button").fadeIn();
                        $("#upload-button").fadeIn();
                        $("#image-input").hide();
                    }
                });
            </script>

            </div>
            
            <div class="dropdown-large" id="profile-images">
                
                <div class="sub-setting" id="profile-img-sub" style="
                
                grid-column-start: 1;
                grid-column-end: 2;
                grid-row: 2;
                position: relative;
                width: 100vw;
                " >


                <div id="profile-image-panel" class="yb-panel-wide">
                    <h4 style="grid-column: 1/3; grid-row: 1; text-align: left;">Profile Images</h4>
                    <div>
                    
                        <b style="margin-bottom: 10px; margin-top: 10px;">Profile Picture</b>
                        <br>
                        <br>
                        <div class='edit-image-options' style="margin-left: 10px;" id='profile-image-options'>
                            <button id="edit-profile-img" class="wide-button" type="button">Edit</button>
                        </div>
                        <script>
                        </script>
                        
                    </div>

                    <div>
                        
                        <b style="position: relative; margin-bottom: 20px; margin-top: 20px;">Profile Background</b> 
                        <br>
                        <br>
                        <div class='edit-image-options' id="background-image-options" style="margin-left: 10px;">
                            <button id="edit-background-img" class="wide-button" type="button">Edit</button>
                            <input style="display:none;" type="file" id='background-img-upload-field' class='image-upload-field'>

                        </div>
                        
                        <br><br>
                    </div>
                </div>



                <div class="yb-panel-wide" style="text-align:left;">
                    <div class="yb-panel-header wide" style="background-color: rgb(60, 60, 60); height: 49px; border-radius: 20px;">
                            
                        <h3 style="margin: 15px auto;">UI Colors</h3>

                        <div style="background-color: rgb(20, 20, 20);  padding: 2px 10px 1px 4px; border-radius: 0px 20px 20px 0px;  display: grid; margin-top: 0px; column-gap: 10px; grid-template-columns: 50px auto; position: absolute; text-align: left; right: 0px;">
                            <label class="yb-switch-round" id="yb-custom-colors" style="margin-top: 8px; grid-column: 1;">
                                <input type="checkbox" class="checkbox" name="custom_colors" id="yb-check-custom-colors">
                                <span class="slider round"></span>
                            </label>
                            <p style="grid-column: 2; margin-top: 12px;">Use Custom Colors</p>
                        
                        </div>
                    </div>                        
                    <div id='icon-color-preview' style='display:grid;'>
                        <div id='space-icon-grid'>
                            <div class='space-icon-preview-active' id='space-icon-1'>
                                <svg class="space-button-image"xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-1' style="fill:{{icon_color}}" d="M5.35 17.9q-2.45 0-4.175-1.725-1.725-1.725-1.725-4.2 0-2.45 1.713-4.188Q2.875 6.05 5.35 6.05q1 0 1.937.325Q8.225 6.7 8.95 7.4l1.525 1.475L8.5 10.65 7.15 9.4q-.375-.35-.838-.525Q5.85 8.7 5.35 8.7q-1.35 0-2.3.962-.95.963-.95 2.338 0 1.35.95 2.3.95.95 2.3.95.5 0 .962-.175.463-.175.838-.525l7.9-7.15q.725-.7 1.663-1.025.937-.325 1.937-.325 2.45 0 4.175 1.725Q24.55 9.5 24.55 11.95q0 2.475-1.713 4.212Q21.125 17.9 18.65 17.9q-1 0-1.937-.325-.938-.325-1.663-1.025l-1.525-1.425 2-1.8 1.325 1.225q.375.35.838.525.462.175.962.175 1.35 0 2.3-.963.95-.962.95-2.337 0-1.35-.95-2.3-.95-.95-2.3-.95-.5 0-.962.175-.463.175-.838.525l-7.9 7.15q-.725.7-1.663 1.025-.937.325-1.937.325Z"/></svg>
                            </div>
                            <div class='space-icon-preview' id='space-icon-2'>
                                <svg class="space-button-image" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-2' style="fill:{{icon_color}}" d="M3 18v-2h12v2Zm0-5v-2h18v2Zm0-5V6h18v2Z"/></svg>
                            </div>
                            <div class='space-icon-preview' id='space-icon-3'>
                                <svg class="space-button-image" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-3' style="fill:{{icon_color}}" d="m9.15 17.15 8-5.15-8-5.15ZM12 22.8q-2.25 0-4.213-.85-1.962-.85-3.424-2.312Q2.9 18.175 2.05 16.212 1.2 14.25 1.2 12t.85-4.225Q2.9 5.8 4.363 4.338q1.462-1.463 3.424-2.301Q9.75 1.2 12 1.2t4.225.837q1.975.838 3.438 2.301 1.462 1.462 2.299 3.437Q22.8 9.75 22.8 12q0 2.25-.838 4.212-.837 1.963-2.299 3.426Q18.2 21.1 16.225 21.95q-1.975.85-4.225.85Zm0-2.65q3.425 0 5.788-2.363Q20.15 15.425 20.15 12t-2.362-5.788Q15.425 3.85 12 3.85q-3.425 0-5.787 2.362Q3.85 8.575 3.85 12q0 3.425 2.363 5.787Q8.575 20.15 12 20.15ZM12 12Z"/></svg>
                            </div>
                            <div class='space-icon-preview' id='space-icon-4'>
                                <svg class="space-button-image" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path id='icon-image-4' style="fill:{{icon_color}}" d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"/></svg>
                            </div>
                        </div>
                        <div id='profile-icon-grid'>
                            <div class='profile-icon-preview' id='profile-icon-1'>
                                <svg class="profile-interact-icon" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-5' style="fill:{{icon_color}};" d="M5 19h1.4l8.625-8.625-1.4-1.4L5 17.6ZM19.3 8.925l-4.25-4.2 1.4-1.4q.575-.575 1.413-.575.837 0 1.412.575l1.4 1.4q.575.575.6 1.388.025.812-.55 1.387ZM17.85 10.4 7.25 21H3v-4.25l10.6-10.6Zm-3.525-.725-.7-.7 1.4 1.4Z"/></svg>
                            </div>
                            <div class='profile-icon-preview' id='profile-icon-2'>
                                <svg name = "request_friend" data-catid="{{profile.id}}" class='profile-interact-icon' xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-6' style="fill:{{icon_color}}" d="M18 14v-3h-3V9h3V6h2v3h3v2h-3v3Zm-9-2q-1.65 0-2.825-1.175Q5 9.65 5 8q0-1.65 1.175-2.825Q7.35 4 9 4q1.65 0 2.825 1.175Q13 6.35 13 8q0 1.65-1.175 2.825Q10.65 12 9 12Zm-8 8v-2.8q0-.85.438-1.563.437-.712 1.162-1.087 1.55-.775 3.15-1.163Q7.35 13 9 13t3.25.387q1.6.388 3.15 1.163.725.375 1.162 1.087Q17 16.35 17 17.2V20Zm2-2h12v-.8q0-.275-.137-.5-.138-.225-.363-.35-1.35-.675-2.725-1.013Q10.4 15 9 15t-2.775.337Q4.85 15.675 3.5 16.35q-.225.125-.362.35-.138.225-.138.5Zm6-8q.825 0 1.413-.588Q11 8.825 11 8t-.587-1.412Q9.825 6 9 6q-.825 0-1.412.588Q7 7.175 7 8t.588 1.412Q8.175 10 9 10Zm0-2Zm0 7Z"/></svg>
                            </div>
                            <div class='profile-icon-preview' id='profile-icon-3'>
                                <svg class="profile-interact-icon" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-7' style="fill:{{icon_color}};" d="M1 20v-4q0-.85.588-1.425Q2.175 14 3 14h3.275q.5 0 .95.25.45.25.725.675.725.975 1.788 1.525Q10.8 17 12 17q1.225 0 2.288-.55 1.062-.55 1.762-1.525.325-.425.762-.675.438-.25.913-.25H21q.85 0 1.425.575Q23 15.15 23 16v4h-7v-2.275q-.875.625-1.887.95Q13.1 19 12 19q-1.075 0-2.1-.337-1.025-.338-1.9-.963V20Zm11-4q-.95 0-1.8-.438-.85-.437-1.425-1.212-.425-.625-1.062-.987Q7.075 13 6.325 13q.55-.925 2.325-1.463Q10.425 11 12 11q1.575 0 3.35.537 1.775.538 2.325 1.463-.725 0-1.375.363-.65.362-1.075.987-.55.8-1.4 1.225Q12.975 16 12 16Zm-8-3q-1.25 0-2.125-.875T1 10q0-1.275.875-2.138Q2.75 7 4 7q1.275 0 2.138.862Q7 8.725 7 10q0 1.25-.862 2.125Q5.275 13 4 13Zm16 0q-1.25 0-2.125-.875T17 10q0-1.275.875-2.138Q18.75 7 20 7q1.275 0 2.138.862Q23 8.725 23 10q0 1.25-.862 2.125Q21.275 13 20 13Zm-8-3q-1.25 0-2.125-.875T9 7q0-1.275.875-2.138Q10.75 4 12 4q1.275 0 2.137.862Q15 5.725 15 7q0 1.25-.863 2.125Q13.275 10 12 10Z"/></svg>
                            </div>
                            <div class='profile-icon-preview' id='profile-icon-4'>
                                <svg class="profile-interact-icon" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path id='icon-image-8' style="fill:{{icon_color}};" d="M4 20q-.825 0-1.412-.587Q2 18.825 2 18V6q0-.825.588-1.412Q3.175 4 4 4h16q.825 0 1.413.588Q22 5.175 22 6v12q0 .825-.587 1.413Q20.825 20 20 20Zm8-7L4 8v10h16V8Zm0-2 8-5H4ZM4 8V6v12Z"/></svg>
                            </div>
                        </div>
                    </div>

                    <div id='color-customizations' style='position: relative; text-align: center; display:grid; grid-template-columns: 70px 70px 70px; margin-bottom: 10px; width: 210px; margin-left: auto; margin-right: auto;'>
                        <div>
                            <input class="color-selector" id="primary-color-select" type="color" name='primary_color' style="display:none;" value="{{bit_background}}">
                            
                            <div name="primary" class="color-circle" id="color-circle-primary" style="width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="primary-color-select">Primary</label>
                        </div>
                        <div>
                            <input style="display:none;" class="color-selector" id="accent-color-select" type="color" name='accent_color' value="{{accent_color}}">
                            <div name="secondary" class="color-circle" id="color-circle-secondary" style="width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="accent-color-select">Secondary</label>
                        </div>
                        <div>
                            <input style="display:none;" class="color-selector" id="icon-color-select" type="color" name='icon_color' value="{{icon_color}}">
                            <div name="icon" class="color-circle" id="color-circle-icon" style="width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="icon-color-select">Icon</label>
                        </div>                    
                    </div>
                </div>

                <div class="yb-panel-wide" style="text-align:left;">
                    <div class="yb-panel-header wide" style="background-color: rgb(60, 60, 60); height: 49px; border-radius: 20px;">
                        <h3 style="margin: 15px auto;">Bits</h3>
                        <div style="background-color: rgb(20, 20, 20); padding: 2px 10px 1px 4px; border-radius: 0px 20px 20px 0px;  display: grid; margin-top: 0px; column-gap: 10px; grid-template-columns: 50px auto; position: absolute; text-align: left; right: 0px;">
                            <label class="yb-switch-round" id="yb-custom-colors" style="margin-top: 8px; grid-column: 1;">
                                <input type="checkbox" class="checkbox" name="custom_colors" id="yb-check-custom-colors">
                                <span class="slider round"></span>
                            </label>
                            <p style="grid-column: 2; margin-top: 12px;">Use Custom Colors</p>
                        </div>
                    </div>
                    <div id='bit-colors-preview' class='bit-preview' style="background-color: {{bit_background}}; display: block; margin-top: 10px;">                        
                        <input id='advanced-color-bit-background' type = "color" style='display: none; position: absolute; z-index: 3; top: 50%; left:50%; transform: translate(-50%, -50%)'>
                        <div id='bit-user-info'>
                            <div id='bit-profile-image'>
                                <img id = 'bit-profile-image-image' src=""> 
                            </div>
                            <p id='preview-name'><strong></strong></p>
                            <p id='preview-username'></p>
                        </div>
            
                        
                        <h3 id='preview-title' style='width: 100%;'><hr>Test<hr></h3>
                        
                        <p id='preview-paragraph'>This a test sentence for preview purposes</p>
                        <div id='preview-feedback-container'>
                            <div class='preview-feedback-button' id='button1' style="background-color:{{feedback_background_color}}"></div>
                            <div class='preview-feedback-button' id='button2' style="background-color:{{feedback_background_color}}"></div>
                            <div class='preview-feedback-button' id='button3' style="background-color:{{feedback_background_color}}"></div>
                            <div class='preview-feedback-button' id='button4' style="background-color:{{feedback_background_color}}"></div>
                            <div class='preview-feedback-button' id='button5' style="background-color:{{feedback_background_color}}"></div>
                        </div>
                        
                    </div>
                    <!--<p style="width: 100%; text-align: center; font-size: 14px; margin-top: 10px;" for='yb-align-text'>Colors</p> -->
                    <div id='bit-color-customizations' style='position: relative; width: 280px; margin-left: auto; margin-right: auto; text-align: center;  display:grid; grid-template-columns: 70px 70px 70px 70px;'>
                        <div>
                            <input style="display:none;" class="color-selector" id="tfont-color-select" type="color" name='title_color' value="{{title_color}}">
                            <div name="title" class="color-circle" id="color-circle-title" style="width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="tfont-color-select">Title</label>
                        </div>
                        <div>
                            <input style="display:none;" class="color-selector" id="pfont-color-select" type="color" name='text_color' value="{{text_color}}">
                            <div name="text" class="color-circle" id="color-circle-text" style="width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="pfont-color-select" >Paragraph</label>
                        </div>
                        <div>

                            <input style="display:none;" class="color-selector" id="feedback-background-color-select" type="color" name='feedback_icon_color' value="{{feedback_icon_color}}">
                            <div name="fb_background" class="color-circle" id="color-circle-fb-background" style="background-color: white; width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="feedback-icon-color-select">Selected Button</label>
                        </div>

                        <div>
                            <input style="display:none;" class="color-selector" id="feedback-icon-color-select" type="color" name='feedback_icon_color' value="{{feedback_icon_color}}">
                            <div name="fb_icon" class="color-circle" id="color-circle-fb-icon" style="background-color: black; width: 30px; height: 30px; border-radius: 50%;"></div>
                            <label class="color-select-label" for="feedback-icon-color-select">Selected Icon</label>

                        </div>
                    </div>
                    
                    <p style="width: 100%; text-align: left; font-size: 14px; margin-top: 10px; margin-bottom: 4px;" for='yb-align-text'>Title Font Style</p>
                    <select type="text" class='yb-single-line-input' name="yb-align-text" id="yb-align-text" style='color: white;'>
                        <option value="arial">Arial</option>
                        <option value="times">Times New Roman</option>
                        <option value="add">Add Fonts</option>
                    </select>
                    <p style="width: 100%; text-align: left; font-size: 14px; margin-top: 10px; margin-bottom: 4px;" for='yb-align-text'>Paragraph Font Style</p>
                    <select type="text" class='yb-single-line-input' name="yb-align-text" id="yb-align-text" style='color: white;'>
                        <option value="arial">Arial</option>
                        <option value="times">Times New Roman</option>
                        <option value="add">Add Fonts</option>
                    </select>
                    <p style="width: 100%; text-align: left; font-size: 14px; margin-top: 10px;" for='yb-align-text'>Paragraph Alignment</p>
                    <div class = "three-part-button-container">
                        <div class = "yb-three-part-left-active">
                            <svg style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path class="three-part-icon-active" d="M120 936v-80h720v80H120Zm0-160v-80h480v80H120Zm0-160v-80h720v80H120Zm0-160v-80h480v80H120Zm0-160v-80h720v80H120Z"/></svg>
                        </div>
                        <div class="yb-three-part-center">
                            <svg style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path class="three-part-icon" d="M120 936v-80h720v80H120Zm160-160v-80h400v80H280ZM120 616v-80h720v80H120Zm160-160v-80h400v80H280ZM120 296v-80h720v80H120Z"/></svg>
                        </div>
                        <div class="yb-three-part-right">
                            <svg style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path class="three-part-icon" d="M120 936v-80h720v80H120Zm240-160v-80h480v80H360ZM120 616v-80h720v80H120Zm240-160v-80h480v80H360ZM120 296v-80h720v80H120Z"/></svg>
                        </div>
                    </div>
                </div>
                <br>

                <br>
                
                    <br>

            </form>
                    
                    <!--
                        Background image upload/select from library
                            Effects
                                -Hue
                                -Brightness
                                -Saturation
                                -Blur

                        Profile image upload/select from library
                            -Alpha PNG Toggle (Enables Transparency)
                            -Border Toggle (Assists with making transparent images look more natural)
                            -Border Type: Squircle, Square, Rectangle
                            -Gif Playback (Loop/Bounce)
                    --> 


                </div>
                
            </div>
            <div class="dropdown-large" id="ui-colors" style="display:none;">
                
                    <form id="color-sub" class="sub-setting" 
                    style="

                    grid-column-start: 1;
                    grid-column-end: 2;
                    grid-row: 2;
                    position: relative;
                    width: 100vw;
                    " 
                    method="POST">            


                    <!--
                        Bit background color
                            -Alpha
                            -Blur
                            -Shadow Toggle
                        Accent color
                        Icon colors
                        Panel Options (Header/Menu)
                            -Hue
                            -Filter Toggle
                            -Background Opacity
                    -->
            </div>

            <div class="dropdown-large" id="bits" style="display:none;">
                <div id="bit-color-sub" clsss='sub-setting' style='grid-column-start: 1;
                grid-column-end: 2;
                grid-row: 2;
                position: relative;'>


                </div>
                

            </div> 
            <div class="dropdown-large" id="fonts" style="display:none;">
                <div id="sub-setting">

                <!--
                    Title Font
                        Type
                        Size
                        Color
                        Weight
                        Border
                    Paragraph Font
                        Type
                        Size
                        Color
                        Weight
                        Border
                -->
                </div>
            </div>
        </div>
        <div id="container-column-2">
            
            <!--Profile page preview container for desktop-->
            <div id="preview">
                <img id="preview-background-img" style="-webkit-filter: brightness(80%) blur(30px);">
                <div id="mini-head" style='backdrop-filter: brightness(200%);'>

                </div>
                <div id="mini-content">
                    <div id="mini-profile-header">
                       <img id="mini-user-image" style="border:2px solid; border-color: {{accent_color}};" src=""/>
                        <p id="mini-user-name">
                            Austin Chaney
                        </p>
                    </div>
                    <hr width="100%" style="position: relative;">
                    <div id="mini-bit" style="background-color: {{ bit_background }};" class="mini-bit">
                        <div id="mini-user-info"></div>
                        <div id="mini-title">Title Preview</div>
                        <div id="mini-paragraph" style="color:{{text_color}};">This is a paragraph preview, it is a preview of paragraph text in paragraphs.</div>
                        
                        <div class="mini-feedback">
                            <div id="like-circle" style="background-color:{{accent_color}}"></div>
                        </div>
                    </div>
                    <br>  
                </div>
            </div>
            
            <!--Dynamic Preview Window for Mobile-->
            
            <br>
            


            <div id="toggles">

                <!--Default, Default Mode (light/dark), show customizations in feed, toggle post colors-->
            </div>
                
        </div>
        <div id="mobile-spacer" style='height: 90px;'>

        </div>
    </div>
    <script type="text/javascript" src="{% static 'scripts/yb_crop.js' %}"></script>
    <script>
        var base_url = window.location.origin;
        MINI_USER_IMAGE_CONTAINER = document.getElementById("accent-color-preview");

        MINI_USER_IMAGE = document.getElementById("profile-image-preview-image");
        MINI_USER_NAME = document.getElementById("preview-name");
        MINI_USERNAME = document.getElementById("preview-username");
        MINI_BIT = document.getElementById("mini-bit");
        MINI_BIT_MOBILE = document.getElementById("bit-colors-preview");
        MINI_TITLE = document.getElementById("mini-title");
        MINI_TITLE_MOBILE = document.getElementById("preview-title");
        MINI_PARAGRAPH = document.getElementById("mini-paragraph");
        MINI_PARAGRAPH_MOBILE = document.getElementById("preview-paragraph");
        BIT_PROFILE_IMAGE = document.getElementById("bit-profile-image-image");
        PAGES = ["#profile-images", "#ui-colors", "#bits", "#fonts"]

        var custom_data = {}

        $(document).ready(function() {
            
            $('#back-to-home').fadeIn('slow');
            $('#back-to-home').animate({'bottom': '110px'});
            $('#content-container').animate({'top':'0px'});
            yb_hideSpaceBar();

            let id = yb_getSessionValues("id");

            let url = `${base_url}/api/custom/${id}/`

            //Fetch customization data on page load
            fetch(url)
            .then((resp) => resp.json())
            .then(function(data){
                let custom = data;
                custom_data = {
                    "profile_image":custom.image,
                    "wallpaper":custom.wallpaper,
                    "primary_color":custom.primary_color,
                    "secondary_color":custom.accent_color,
                    "icon_color": custom.icon_color,
                    "feedback_icon_color": custom.feedback_icon_color,
                    "feedback_icon_background": custom.feedback_icon_background,
                    "blur_radius": custom.blur_radius,
                    "background_dim": custom.background_dim,
                    "title_color": custom.title_color,
                    "text_color":custom.text_color,
                }

                
                MINI_USER_IMAGE.setAttribute("src", custom_data.profile_image);
                MINI_USER_IMAGE_CONTAINER.style.borderColor = custom_data.secondary_color;
                BIT_PROFILE_IMAGE.setAttribute("src", custom_data.profile_image);
                BIT_PROFILE_IMAGE.style.borderColor = custom_data.secondary_color;
                MINI_BIT.style.backgroundColor = custom_data.primary_color;
                MINI_BIT_MOBILE.style.backgroundColor = custom_data.primary_color;

                MINI_USER_NAME.style.color =custom.title_color;
                MINI_USERNAME.style.color =custom.title_color;

                MINI_TITLE.style.color = custom.title_color;
                MINI_TITLE_MOBILE.style.color = custom.title_color;
                MINI_PARAGRAPH.style.color = custom.text_color;
                MINI_PARAGRAPH_MOBILE.style.color = custom.text_color;

                //Fill UI colors
                $("#primary-color-select").attr("value", custom_data.primary_color);
                $("#accent-color-select").attr("value", custom_data.secondary_color);
                $("#icon-color-select").attr("value", custom_data.secondary_color);
                $("#color-circle-primary").css("background-color", custom_data.primary_color);
                $("#color-circle-secondary").css("background-color", custom_data.secondary_color);
                $("#color-circle-icon").css("background-color", custom_data.icon_color);
                $("#color-circle-title").css("background-color", custom_data.title_color);
                $("#color-circle-text").css("background-color", custom_data.text_color);
                $("#color-circle-fb-icon").css("background-color", custom_data.feedback_icon_color);
                $("#color-circle-fb-background").css("background-color", custom_data.feedback_icon_background);

                //Fill Bit Colors
                $("#tfont-color-select").attr("value",custom.title_color);
                $("#pfont-color-select").attr("value", custom.text_color);
                $("#feedback-background-color-select").attr("value", custom.feedback_icon_background);
                $("#feedback-icon-color-select").attr("value", custom.feedback_icon_color);



            });

        $('.color-circle').click(function(){
            let this_name = $(this).attr("name");
            if (this_name === "primary"){
                showColorOption('#primary-color-select', focusIn);
            }
            else if (this_name === "secondary"){
                showColorOption("#accent-color-select", focusIn);
            }
            else if (this_name === "icon"){
                showColorOption("#icon-color-select", focusIn);
            } 
            else if (this_name === "title"){
                showColorOption("#title-color-select", focusIn);
            }
            else if (this_name === "text"){
                showColorOption("#text-color-select", focusIn);
            }
            else if (this_name === "fb_icon"){
                showColorOption("#feedback-icon-color-select", focus);

            } else if (this_name === "fb_background"){
                showColorOption('feedback-background-color-select');

            }

        })
            
        //Event listener for image select button
        let profile_image_edit_button = document.getElementById("edit-profile-img");
        profile_image_edit_button.addEventListener("click", function(){
            $("#profile-images").fadeOut();
            $("#yb-browse-nav").animate({"top":"-100px"}, "fast").fadeOut("slow");
            $("#profile-cropper").fadeIn();

        });

        let bkd_image_edit_button = document.getElementById("edit-background-img");
        bkd_image_edit_button.addEventListener("click", function(){
            $("#profile-images").fadeOut();
            $("#yb-browse-nav").animate({"top":"-100px"},"fast").fadeOut("slow");
            $("#background-cropper").fadeIn();

        });


            
        });

        function showImageSelection() {
            let selector_container = document.getElementById("image-selector");
            selector_container.style.display = "block";
            $("#image-selector").animate({"height": "65vh", "width":"95vw"}, "fast");
            
            //Set URL for api to fetch photos
            let url = "/api/photos/"
            
            //Fetch photos from API and put them into create grid function
            fetch(url)
            .then((resp) => resp.json())
            .then(function(data){
                yb_createImageGrid(data);
                
            });
        }

        //Function for laying images out on a grid
        function yb_createImageGrid(data) {
            const container = document.querySelector('.image-grid-container');
            data.forEach(item => {
                let image = yb_renderImage(item.image, `yb-photo-${item.id}`, "yb-photo-tile");
                image.src = item.image;
                image.setAttribute("data-id", item.id);
                container.appendChild(img);
            })
        }
        /* let uploadButton = document.getElementById("image-upload-button");
        uploadButton.addEventListener("click", function(){
            if ($(this).attr("data-state") === "upload"){
                $("#profile-img-upload-field").fadeIn();
                $(this).html("Cancel");
                $(this).attr("data-state", "cancel")
            } else {
                $("#profile-img-upload-field").fadeOut();
                $(this).html("Upload");
                $(this).attr("data-state", "upload")
            }
        });*/

 
        $(".filter-button").click(function() {
            let this_name = $(this).attr("name");
            $(".dropdown-large").fadeOut();
            $(".filter-button-wide-active").attr("class","filter-button");
            $(this_name).fadeIn();
            $(this).attr("class","filter-button-wide-active");
        });

        $(".filter-button-wide-active").click(function() {
            let this_name = $(this).attr("name");
            $(".dropdown-large").fadeOut();
            $(".filter-button-wide-active").attr("class","filter-button");
            $(this_name).fadeIn();
            $(this).attr("class","filter-button-wide-active");
        });
        
        $('#back-to-home').click(function() {
            window.location.href = `${base_url}/bitstream/home/`
        });

        $('#bit-colors-preview').click(function() {
            showColorOption('#advanced-color-bit-background', focusIn)
            
        });
        
        function showColorOption(field, callback) {
            $(field).show();
            callback(field);
        }
        function focusIn(field){
            $(field).focus();
        }
        
        function hideColorOption(field) {
            $(field).hide();
        }
        function focusOut(field){
            $(field).blur();
        }
        

        var profile_image_loaded;

        var preview_stage = 0;
        



        function hideElement(sub_setting) {
            sub_setting.style.display = "none";
        }


        /* let profile_bkd_field = document.getElementById('bkd-image-field');
        profile_bkd_field.addEventListener("change", function() {
            let image_preview = document.getElementById('preview-background-img');
            const image_loaded = this.files[0];
            if (image_loaded) {
                const reader = new FileReader();

                reader.addEventListener('load', function() {
                    image_preview.setAttribute('src', this.result);
                    updateCustom('image_upload', 'background_image', image_loaded)
                });

                reader.readAsDataURL(image_loaded);

            }
        }); */

        /*let profile_img_field = document.getElementById('profile-img-upload-field');
        profile_img_field.addEventListener("change", function() {
            let user_image_preview = document.getElementById('profile-image-preview-image');
            const image_loaded = this.files[0];
            if (image_loaded) {
                const reader = new FileReader();

                reader.addEventListener('load', function() {

                    updateCustom('image_upload', 'profile_image', image_loaded)
                    $("#profile-img-upload-field").fadeOut();
                    $("#image-upload-button").html("Upload");
                    $("#image-upload-button").attr("data-state", "upload");
                });

                reader.readAsDataURL(image_loaded);

            }
        }); */

        $('#toggle-colors').change(function() {
            let color_option = document.getElementById('color-customizations');
            if ( color_option.style.display === 'none') {
                $('#color-customizations').animate({'height': '15vh'}, 'slow');
            }
            else {
                $('#color-customizations').animate({'height': '0vh'}, 'slow');
            }
        }); 

        function yb_ContrastColor(value){
            let csrfToken = getCSRF();
            let request = new FormData();
            let url = `${base_url}/profile/api/contrast/`;
            request.append('hex_code', value);
            $.ajax({
                type: 'POST',
                contentType: false,
                // The following is necessary so jQuery won't try to convert the object into a string
                processData: false,
                headers: {
                    
                    'X-CSRFToken': csrfToken
                },
                url: url,
                data: request,
                success: function(response) {
                    let text_color_field = document.getElementById('pfont-color-select');
                    let text_color_preview = document.getElementById('preview-paragraph');

                    let color = response.text;

                    console.log(color)

                    text_color_field.value = color;

                    $("#preview-paragraph").css({"color": color});
                                
                }
            });
        }

        
        const primary_color_field = document.getElementById('primary-color-select')
        primary_color_field.addEventListener("change", function() {
            let bit_background = document.getElementById('bit-colors-preview');
            
            $("#color-circle-primary").css("transition", "0.5s");
            $("#color-circle-primary").css("background-color", this.value);
            hideColorOption('#primary-color-select');



            bit_background.style.backgroundColor = this.value;
            updateCustom('color_change', 'primary', this.value)
        });

        const accent_color_field = document.getElementById('accent-color-select')
        accent_color_field.addEventListener("change", function() {
            let border1 = document.getElementById('accent-color-preview');
            let border2 = document.getElementById('bit-profile-image');
            border1.style.borderColor = this.value;
            border2.style.borderColor = this.value;
            $('#profile-pic').css({'border-color': this.value});
            updateCustom('color_change', 'secondary', this.value);

            $("#color-circle-secondary").css("transition", "0.5s");
            $("#color-circle-secondary").css("background-color", this.value);
            hideColorOption('#accent-color-select');
           
        });

        const feedback_icon_field = document.getElementById('feedback-icon-color-select');
        feedback_icon_field.addEventListener('change', function() {
            $("#color-circle-fb-icon").css("transition", "0.5s");
            $("#color-circle-fb-icon").css("background-color", this.value);
            let feedback_preview1 = document.getElementById('button1').style.backgroundColor = this.value;
            let feedback_preview2 = document.getElementById('button2').style.backgroundColor = this.value;
            let feedback_preview3 = document.getElementById('button3').style.backgroundColor = this.value;
            let feedback_preview4 = document.getElementById('button4').style.backgroundColor = this.value;
            let feedback_preview5 = document.getElementById('button5').style.backgroundColor = this.value;
            updateCustom('color_change', 'feedback_icon', this.value);
            hideColorOption('#feedback-icon-color-select');
            
        });

        
        const icon_field = document.getElementById('icon-color-select');
        icon_field.addEventListener('change', function() {
            $("#color-circle-icon").css("transition", "0.5s");
            $("#color-circle-icon").css("background-color", this.value);
            let space_icon1 = document.getElementById('icon-image-1').style.fill = this.value;
            let space_icon2 = document.getElementById('icon-image-2').style.fill = this.value;
            let space_icon3 = document.getElementById('icon-image-3').style.fill = this.value;
            let space_icon4 = document.getElementById('icon-image-4').style.fill = this.value;
            let space_icon5 = document.getElementById('icon-image-5').style.fill = this.value;
            let space_icon6 = document.getElementById('icon-image-6').style.fill = this.value;
            let space_icon7 = document.getElementById('icon-image-7').style.fill = this.value;
            let space_icon8 = document.getElementById('icon-image-8').style.fill = this.value;
            $('.space-button-icon').css({'fill':this.value});
            $('.mobile-floating-actions-path').css({'fill': this.value});
            $('.mobile-floating-actions').css({'border-color': this.value});
            updateCustom('color_change', 'icon', this.value);
            hideColorOption('#icon-color-select');
            
        });

        const text_color_field = document.getElementById('pfont-color-select');
        text_color_field.addEventListener('change', function() {
            $("#color-circle-text").css("transition", "0.5s");
            $("#color-circle-text").css("background-color", this.value);
            let text_color_preview = document.getElementById('preview-paragraph');
            text_color_preview.style.color = this.value;
            updateCustom('color_change', 'paragraph_font', this.value);
            hideColorOption('#text-color-select');
        });

        const title_color_field = document.getElementById('tfont-color-select');
        title_color_field.addEventListener('change', function() {
            $("#color-circle-title").css("transition", "0.5s");
            $("#color-circle-title").css("background-color", this.value);
            let title_color_preview = document.getElementById('preview-title');
            title_color_preview.style.color = this.value;
            updateCustom('color_change', 'title_font', this.value);
            hideColorOption('#tfont-color-select');
        });

        const paragraph_align_field = document.getElementById('yb-align-text');
        paragraph_align_field.addEventListener('change', function() {
            $('#preview-paragraph').css({'text-align': this.value});
            updateCustom('text_edit', 'para-align', this.value);
            
        });

        accent_color_field.addEventListener('click', function() {
            if (preview_stage === 1) {
                $('#bit-colors-preview').fadeOut();
                $('#accent-color-preview').fadeIn();
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#accent-color-preview').fadeIn();
            }

            preview_stage = 0
        });

        icon_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#icon-color-preview').fadeIn();
            }
            if (preview_stage === 1) {
                $('#bit-colors-preview').fadeOut();
                $('#icon-color-preview').fadeIn();
            }
            preview_stage = 2
        });

        title_color_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            preview_stage = 1
        });

        text_color_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            preview_stage = 1
        });

        feedback_icon_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            preview_stage = 1
        });
        primary_color_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
                showColorOption('#', focusIn)
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            preview_stage = 1
        });

        paragraph_align_field.addEventListener('click', function() {
            if (preview_stage === 0) {
                $('#accent-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            if (preview_stage === 2) {
                $('#icon-color-preview').fadeOut();
                $('#bit-colors-preview').fadeIn();
            }
            preview_stage = 1
        });

        </script>
