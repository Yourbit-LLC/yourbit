<!DOCTYPE html>

<html>
    {% load static %}
    <head>
        <!--Link CSS documents for styling-->
        <link rel="stylesheet" type="text/css" href="{% static 'css/onboarding.css' %}"/>
        <link rel="stylesheet" type="text/css" href="{% static 'css/yourbit_core.css' %}"/>
        
        <!--Page title welcoming user-->
        <title>Welcome, {{ user.first_name }}</title>
        
        <!--
            
            Maximum scale is set to 1 to prevent zooming when form fields are selected in the web version, 
            tests found traditional zooming is not prevented on any browser with setting enabled.
        
        -->
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1">

    </head>

    <!--Import cropper js and styling-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />
    
    <!--Global script on top because all functions are only used by other scripts-->
    <script type="text/javascript" src="{% static 'scripts/yb-global.js' %}"></script>
    
    
    <body>

        <!--Background image element-->
        <img id='bg-image' style='opacity:0;' class='bg-image' src=''>

        <!--Opening message introducing user to the onboarding section of signup-->
        <div id='onboard-welcome' style='position: absolute; z-index: 2; width: 95%; margin-top: 100px; margin-left: auto; margin-right: auto; text-align: center;'>
            <p>
                <h3>Welcome aboard, {{user.first_name}}!</h3>
                
                You are almost to Yourbit. On our way, we're going to configure
                your initial profile settings with your preferences. Yourbit has
                a ton of options for managing appearance, your exposure, and what
                you see, this step will introduce you to the most important concepts.
                <br>
                <br>
                <button class="yb-pages-next" data-step = '0'>OK!</button>
            </p>
        </div>

<!--

    Onboarding step 1: Profile Images
    This step consists of uploading a profile picture and a background picture

-->

        <div id='profile-images' style="position:absolute; z-index: 2; text-align: center; display:none; left: 100vw;">
            <h3 style="text-align: center;">Profile Images</h3>
            <p style="text-align: center;">You can upload a profile image and a background image to personalize your space</p>
            <div class='image-preview'>
                <div class='profile-image-preview-main'>
                    <img id='profile-image-preview-image' class='profile-image-preview-image' src="{{user_image.url}}">
                </div>

            </div>      
            
            <!--Place a cb-divider, which is a yourbit element used to dim the background between a pop up element-->
            <div class="cb-divider" style = "display: none; top: 0; left: 0; width: 100vw; height: 100vh; position: fixed; z-index: 24; -webkit-backdrop-filter: brightness(30%); backdrop-filter: brightness(30%);">
            </div>

            <!--Cropper container, this contains the area that the cropper will be placed for profile images on upload-->
            <div class="yb-cropper-container profile-image">
                <img id="profile-image-preview" style="object-fit: contain; max-width:100%; max-height: 250px;"/>
                <input type="hidden" id="cropper-output" value="">
                <div id="profile-cropper-submission-controls" style="display:none; width:100%; background-color: rgba(0, 0, 0, 0.5);">
                    <button id="profile-advanced-options-button" style="margin-top: 2px; position: absolute; left: 5px;" class = "yb-form-button">Show Advanced Options</button>
                    <button id="profile-image-cropper-save" class="yb-form-button" type = "button" style="background-color: darkgreen; position: absolute; right: 5px;" onclick="uploadImage('profile-image')">Save</button>
                </div>  
                <script>
                    let input = document.getElementById('profile-image-input');
                    let save_button = document.getElementById('profile-image-cropper-save');
                    save_button.addEventListener('click', function(){
                        
                        let profile_image_preview = document.getElementById('profile-image-preview');
                        let profile_cropper_controls = document.getElementById('profile-cropper-submission-controls');
                        let cropper = document.querySelector('.cropper-container'); 
                        let input_field = document.getElementById('profile-image-input');
                        let form = document.querySelector('.upload-field');

                        input_field.style.display = 'none';
                        profile_image_preview.style.display = 'none';
                        profile_cropper_controls.style.display = 'none';

                        
                        let complete_container = yb_createElement('div', 'profile-image-upload-complete', 'complete_message');
                        complete_container.style.width = 'fit-content';
                        complete_container.style.marginLeft = 'auto';
                        complete_container.style.marginRight = 'auto';
                        complete_container.style.marginTop = '10px';
                        $(".cb-divider").fadeOut();


                        let icon = `<svg style="position: relative; grid-column: 1; margin:auto;" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path style="fill:green" d="m424 760 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197 859q-54-54-85.5-127T80 576q0-83 31.5-156T197 293q54-54 127-85.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 83-31.5 156T763 859q-54 54-127 85.5T480 976Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>`
                        complete_container.innerHTML = `<div style="display:grid; grid-template-columns: 30px 130px;">${icon} <p style="grid-column: 2; margin: auto;">Image Uploaded!</p></div>`;
                        form.appendChild(complete_container);

                    });
                </script>
            </div>

            <!--Cropper container background, this contains the area that the cropper will be placed in when a background image is loaded-->
            <div class="yb-cropper-container background">
                <img id="background-image-preview" style="object-fit: contain; display: none; max-width:100%; max-height: 250px; margin-left: auto; margin-right: auto;"/>
                <input type="hidden" id="cropper-output" value="">
                <div id="background-cropper-submission-controls" style="display:none; width:100%; text-align:center;">
                    
                    <button id="background-advanced-options-button" style="margin-top: 2px; position: absolute; left: 5px;" class = "yb-form-button">Show Advanced Options</button>
                    <button id="background-image-cropper-save" class="yb-form-button" type="button" style="background-color: darkgreen; position: absolute; right: 5px;" onclick="uploadImage('background-image')">Save</button>
                    
                </div>
                <script>

                    let save_button_2 = document.getElementById('background-image-cropper-save');
                    save_button_2.addEventListener("click", function() {
                        
                        let profile_image_preview = document.getElementById('background-image-preview');
                        let profile_cropper_controls = document.getElementById('background-cropper-submission-controls');
                        let cropper = document.querySelectorAll('.cropper-container'); 
                        console.log(cropper)


                        
                        let input_field = document.getElementById('background-image-input');
                        let form = document.getElementById('background-image-onboard-container');
                        input_field.style.display = 'none';
                        profile_image_preview.style.display = 'none';
                        profile_cropper_controls.style.display = 'none';
                        
                        
                        let complete_container = yb_createElement('div', 'profile-image-upload-complete', 'complete_message');
                        complete_container.style.width = 'fit-content';
                        complete_container.style.marginLeft = 'auto';
                        complete_container.style.marginRight = 'auto';
                        complete_container.style.marginTop = '10px';
                        
                        $(".cb-divider").fadeOut();

                        let icon = `<svg style="position: relative; grid-column: 1; margin:auto;" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path style="fill:green" d="m424 760 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197 859q-54-54-85.5-127T80 576q0-83 31.5-156T197 293q54-54 127-85.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 83-31.5 156T763 859q-54 54-127 85.5T480 976Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>`
                        complete_container.innerHTML = `<div style="display:grid; grid-template-columns: 30px 130px;">${icon} <p style="grid-column: 2; margin: auto;">Image Uploaded!</p></div>`;
                        form.appendChild(complete_container);

                    })
                    
                </script>
            </div>

            <!--Profile Image Upload Form-->
            <form method="POST" class='upload-field' enctype="multipart/form-data" style="background-color: rgba(0, 0, 0, 0.8); position: relative; width: 90vw; left: 50%; transform: translate(-50%, 0);">
                    {% csrf_token %}
                    <h4>Profile Picture</h4>
                    
                    <input type="file" id="profile-image-input" style="width:225px;" onchange="previewImage('profile-image')" />


            </form>


            <!--Background image upload form-->
            <form class='upload-field' id="background-image-onboard-container" method="POST" enctype="multipart/form-data" style="background-color: rgba(0, 0, 0, 0.8); position: relative; width: 90vw; left: 50%; transform: translate(-50%, 0);">
                {% csrf_token %}
                <h4>Profile Skin</h4> 
                <input type="file" id="background-image-input" onchange = "previewImage('mobile-background')" style="width:225px;" />

                
            </form>
            <button class="yb-pages-back" data-step = '1'>Back</button>
            <button style='margin-left: auto; margin-right: auto;' class="yb-pages-next" data-step = '1';>Next</button>
        </div>


        <!--Profile Information Section-->
        <div id="profile-setup" style="position:absolute; z-index: 2; display:none; text-align: center; width: 100vw; left: 100vw;">
            <h2>Profile Info</h2>
            <p>Let's get to know you a little more</p>
            <br>
            <label for='gender-field' name='gender'>Gender</label>
            <br>
            <select type="text" class='yb-single-line-input' name="yb-align-text" id="gender-field" style='color: white;' placeholder="Paragraph Align">
                <option value="M">Male</option>
                <option value="F">Female</option>
                <option value="O">Other/Prefer not to say</option>
            </select>
            <br>
            <br>
            <label for="motto-field">Motto</label>
            <br>
            <input type="text" name='motto' class='yb-single-line-input' id="motto-field" placeholder="What's your motto?" style="color:white; font-size: 14px;">
            <br>
            <br>
            <label for='bio-field' >Bio</label>
            <br>
            <textarea  type="text" name='bio' class='yb-form-multi-line-field' id="bio-field" placeholder="Tell us about yourself!" style="color:white; font-size: 14px;"></textarea>
            <br>
            <br>
            <button class="yb-pages-back" data-step = '2'>Back</button>
            <button class="yb-pages-next" data-step = '2'>Next</button>
            
        </div>

<!--
    
    Onboarding Step 3: Privacy Options
    This step allows users to configure important initial privacy settings
    such as who can see their real name, who can message them, etc.

    Scope Identifiers:
        - E: Everyone
        - F2: Friends Of Friends
        - FF: Friends and Followers
        - FO: Friends Only
        - NO: No One
        
-->

        <div id='profile-privacy' style='position:absolute; left: 100vw; display:none; z-index: 2; text-align: center;'>
            <!--Section Header-->
            <h2>Privacy</h2>
            
            <!--Introductory description-->
            <p>
                Yourbit has many ways of managing your privacy
                precisely how you want to, here we'll get the basics
                set up for you.
            </p>
            <br>

            <!--Choose who can see your real name-->
            <label for='name-check' >Who can see your real name?</label>
            <br>
            <!--Dropdown selection of 3 different options-->
            <select type="text" class='yb-single-line-input' name="yb-name-check" id="name-check" style='color: white;' placeholder="Select from list:">
                <option value="E">Everyone</option>
                <option value="FO">Friends Only</option>
                <option value="NO">Nobody</option>
            </select>

            <br>
            <br>

            <!--Specify who can message you-->
            <label for='message-check' >Who can message you?</label>
            <br>
            <!--Dropdown selection containing 4 different options-->
            <select type="text" class='yb-single-line-input' name="yb-name-check" id="message-check" style='color: white;' placeholder="Select from list:">
                <option value="E">Everyone</option>
                <option value="FF">Friends and Following</option>
                <option value="FO">Friends Only</option>
                <option value="NO">Nobody</option>
            </select>
            <br>
            <div style='width:90vw; margin-left:auto; margin-right:auto; position: relative; height: fit-content; text-align:left;'>
                <br>
                <br>
                <input type='checkbox'class='yb-form-checkbox' id='visibility-check'>
                <label for='visibility-check'>Hide real name in search?</label>
                <br>
                <br>
                <input type='checkbox' class='yb-form-checkbox' id='toggle-followers' checked>
                <label for='toggle-followers'>Enable Followers</label>
            </div>
            <br>
            <br>
            <button class="yb-pages-back" data-step = '3'>Back</button>
            <button class="yb-pages-next" data-step = '3'>Next</button>
        </div>

<!--
    
    Onboarding Step 4: Profile Personalization Section

-->
        <div id='profile-personalization' style="position: absolute; z-index: 2; display:none; left: 100vw; text-align: center;">
            <h4>Personalization</h4>
            <p>
                We are all set with basic info. Now, let's give your 
                profile a splash of You. On the next page,
                you'll be presented with options for customizing various
                color and text settings on your profile. You can express 
                your individuality through color with a unique style that 
                allows you to stand out in the crowd.

            </p>
            <button class="yb-pages-back" data-step = '4'>Back</button>
            <button class="yb-pages-next" data-step = '4'>Let's Go!</button>
        </div>
        
    </body>

    <!--Page scripts-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'scripts/yb_crop.js' %}"></script>
    <script type="text/javascript" src="{% static 'scripts/yb-ajax.js' %}"></script>
    <script type="text/javascript" src="{% static 'scripts/onboarding.js' %}"></script>
</html>