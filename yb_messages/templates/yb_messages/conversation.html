{% load static %}

    <link rel="stylesheet" type="text/css" href="{% static 'css/conversation/yb_conversation.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/main/yb_core.css' %}"/>

    <input id='csrf-token' type='hidden' value={{csrf_token}}>
    <div id='message-header' class="yb-autoFill" style='text-align:center; color: white;'>
        <svg id="back-to-convos" xmlns="http://www.w3.org/2000/svg" style="position: absolute; left: 15px; top: 50%; transform: translate(0, -50%);" height="24" width="24"><path class="yb-autoFill"  d="M10 22 0 12 10 2l1.775 1.775L3.55 12l8.225 8.225Z"/></svg>
        <h3 class="yb-autoText" id="receiver-name" style="margin-top:15px; margin-bottom: 2px;">{{conversation_name}}</h3>
        <p class="yb-autoText" style='margin-top:0px;'><small>offline</small></p>
        <svg id="options-button" xmlns="http://www.w3.org/2000/svg" style = "position: absolute; right: 15px; top: 50%; transform: translate(0, -50%);" height="24" width="24"><path class="yb-autoFill" d="M12 20q-.825 0-1.412-.587Q10 18.825 10 18q0-.825.588-1.413Q11.175 16 12 16t1.413.587Q14 17.175 14 18q0 .825-.587 1.413Q12.825 20 12 20Zm0-6q-.825 0-1.412-.588Q10 12.825 10 12t.588-1.413Q11.175 10 12 10t1.413.587Q14 11.175 14 12q0 .825-.587 1.412Q12.825 14 12 14Zm0-6q-.825 0-1.412-.588Q10 6.825 10 6t.588-1.412Q11.175 4 12 4t1.413.588Q14 5.175 14 6t-.587 1.412Q12.825 8 12 8Z"/></svg>
        <div id="conversation-data" data-id="{{conversation.id}}" data-primary-color = "{{request.user.profile.custom.primary_color}}" data-receiver-username="{{conversation.receiver.username}}" data-receiver="{{conversation.receiver.id}}" data-sender-id = "{{request.user.id}}"></div>
    </div>

    <div id='message-container'>
        <!--Messages are appended here-->
        {% for message in messages reversed %}
            {% if message.from_user == request.user %}
                
                    <div id="message-{{message.id}}" class='message-bubble message-bubble-right'>
                        <div class="message-body">{{ message.body }}</div>
                    </div>
                

                    <div class='message-timestamp' style="display:none;">
                        <div class="message-time">{{ message.time }}</div>

                    </div>
            
            

            {% else %}
                
                    <div id="message-{{message.id}}" class='message-bubble message-bubble-left'>
                        <div class="message-body">{{ message.body }}</div>
                    </div>


                    <div class='message-timestamp' style="display: none;">
                        <div class="message-time">{{ message.time }}</div>

                    </div>
                
            

            {% endif %}
        {% endfor %}

    </div>

    <div id="message-input">
        <div style="grid-column: 1; margin-bottom: 5px;">
        
            <button id="add-attachment" class="yb-button-round">                    
                <svg class="yb-font-white yb-center-transform all" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                    <path d="M434.5-434.5H191.869v-91H434.5v-242.631h91V-525.5h242.631v91H525.5v242.631h-91V-434.5Z"/>
                </svg>
            </button>
        
        </div>

        <div style="grid-column: 2; margin-bottom: 5px;">
            
            <input id="message-field" type="text"  class="yb-input-singleLine" placeholder="Type message">
            
        </div>

        <div style="grid-column: 3; margin-bottom: 5px;">
            
            <button id="send-button"  class="yb-button-round" disabled>Send</button>
        </div>    
    </div>


<script class="page-script" type='text/javascript' type="text/css" src="{% static 'scripts/yb_messages/yb_conversation.js' %}"></script>
